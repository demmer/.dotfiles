#!/usr/bin/perl

if ($#ARGV > 1) {
    print "usage: rungrep <pattern> <file>\n";
    exit(1);
}


$pat = $ARGV[0];
$file = $ARGV[1];

if ($file eq "") {
    $file = $ENV{HOME} . "/.xinitrc";
}

$ENV{RUNGREP} = 1;

open(FILE, "< $file") || die "can't open $file";
    
while (<FILE>) {
    if (/$pat/) {
	$cmd = $_;
	chomp($cmd);
	while ($cmd =~ s/\\\s*$//) {
	    $_ = <FILE>;
	    s/^\s+/ /;
	    $cmd = $cmd . $_;
	}
	system($cmd);
    }
}
