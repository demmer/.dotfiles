VERBOSE=no
MAILDIR=$HOME/Mail
LOGFILE=$HOME/Mail/procmaillog
LOGABSTRACT=all

#
# Mailing lists that I want into separate folders before spooling
#
:0
* List-Post: .*spamassassin-users
sa-talk

:0
* List-Id: .*pair-notices
pair-notices

#
# Annoying aol mail bounces that don't get kicked by spamassassin
#
:0
* ^From: .*MAILER-DAEMON@aol\.com
{
	:0 B bh
	* ^X-Mailer: .*Outlook
	| resubject-spam >> $HOME/Mail/spam
}

#
# Kill the really bad spam (8 pts or higher). 
#
:0
* ^X-Spam-Level: \*\*\*\*\*\*\*\*
| resubject-spam >> $HOME/Mail/spam

#
# And anything to p@demmerfamily.com
#
:0
* ^To: .*p@demmerfamily\.com 
| resubject-spam >> $HOME/Mail/spam

#
# And 4 points or more gets copied to the spam folder.
#
:0
* ^X-Spam-Level: \*\*\*\*
| resubject-spam >> $HOME/Mail/spam-maybe

#
# Automatic email delivery testing
#
:0
* ^To: test-delivery.*
/dev/null

#
# Rotate command since I can't run cron
#
:0bhf
* ^To: rotate-spool
| rotate-spool

#
# Add a subject line for everything.
#
:0fh
* ^Subject:[ ]*$
| formail -I "Subject: (none)"

#
# Filter out links I don't want to show up in urlview all the time
#
:0fh
*
| filter-links

#
# Save a copy of html mail unmodified, just in case.
#
:0c
* ^content-type: text/html
html

#
# Strip out htmlification from the message body and change the
# Content-Type header
#
:0bhfw
* ^content-type: text/html
| dehtml.pl

#
# Modify the subject line for other email addresses
#
:0
* ^Received:.*for <mjd@acm\.org>
{
    :0c
    * .*
    | formail -x Subject > /tmp/subject

    :0f
    * .*
    | formail -i "Subject: [acm]`(cat /tmp/subject && rm -f /tmp/subject)`"
}

#
# Send periodic mail to the inbox w/o spooling
:0
* Subject:.*(security run|daily run|weekly run|monthly run) output
$DEFAULT

:0
* Subject: Cron .* run-parts .*
$DEFAULT

:0
* Subject: DailyTao.org.*
$DEFAULT

#
# Save a copy of all mail into the spool mailbox, marking as already read.
#
:0c
| formail -I "Status: RO" >> $HOME/Mail/spool

#
# Get rid of duplicate messages after saving a copy to the spool.
#
:0 Wh: msgid.lock
| formail -D 32768 msgid.cache

#
# Now some other lists
#
:0
* Mailing-List: .*inkt.*
inkt-crap


#
# C'est fini.
#
