VERBOSE=no
MAILDIR=$HOME/Mail
LOGFILE=$HOME/Mail/procmaillog
LOGABSTRACT=all

#
# Anti-spam filter
#
:0fw
| $HOME/sa/usr/bin/spamassassin -a

:0:
* ^X-Spam-Status: Yes
spam

#
# Automatic email delivery testing
#
:0
* ^To: test-delivery.*
/dev/null

#
# Rotate command since I can't run cron
#
:0f
* ^To: rotate-spool
| rotate-spool

#
# Add a subject line for everything.
#
:0fh
* ^Subject:[ ]*$
| formail -I "Subject: (none)"

#
# Strip out htmlification from the message body and change the
# Content-Type header
#
:0bhf
* ^content-type: text/html
| dehtml.pl

#
# Modify the subject line for other email addresses
#
:0
* ^Received:.*for <mjd@acm\.org>
{
    :0c
    * .*
    | formail -x Subject > /tmp/subject

    :0f
    * .*
    | formail -i "Subject: [acm]`(cat /tmp/subject && rm -f /tmp/subject)`"
}

#
# Send mailing list traffic to separate mailboxes before spooling a copy
#
:0
* ^X-Mailing-List: linux-kernel@vger.kernel.org
linux-kernel

:0
* ^X-Envelope-To: netfilter@demmer.nu
netfilter

#
# Send periodic mail to the inbox w/o spooling
:0
* Subject:.*(security run|daily run|weekly run|monthly run) output
$DEFAULT

#
# Save a copy of all mail into the spool mailbox, marking as already read.
#
:0c
| formail -I "Status: RO" >> $HOME/Mail/spool

#
# Get rid of duplicate messages
#
:0 Wh: msgid.lock
| formail -D 32768 msgid.cache

